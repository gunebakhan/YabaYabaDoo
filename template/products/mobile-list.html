{% extends 'products/products-list.html' %}
{% load static %}
{% block sidebar %}

<div class="mt-2 bg-white p-3 round">
    <div id="titleMain"> مرتب‌سازی بر اساس:</div>
    <form action="">
        <div class="form-check mr-3">
            <input class="form-check-input" type="radio" name="sorting" id="views" value="views">
            <label class="form-check-label" for="sorting">
                <span class="pr-3">پربازدیدترین</span>
            </label>
        </div>
        <div class="form-check mr-3">
            <input class="form-check-input" type="radio" name="sorting" id="sell" value="sell">
            <label class="form-check-label" for="sell">
                <span class="pr-3">پرفروش‌ترین</span>
            </label>
        </div>
        <div class="form-check  mr-3">
            <input class="form-check-input" type="radio" name="sorting" id="popular" value="popular">
            <label class="form-check-label" for="popular">
                <span class="pr-3">محبوب‌ترین</span>
            </label>
        </div>
        <div class="form-check mr-3">
            <input class="form-check-input" type="radio" name="sorting" id="new" value="new">
            <label class="form-check-label" for="new">
                <span class="pr-3">جدیدترین</span>
            </label>
        </div>
        <div class="form-check mr-3">
            <input class="form-check-input" type="radio" name="sorting" id="cheap" value="cheap">
            <label class="form-check-label" for="cheap">
                <span class="pr-3">ارزان‌ترین</span>
            </label>
        </div>
        <div class="form-check mr-3">
            <input class="form-check-input" type="radio" name="sorting" id="expensive" value="expensive">
            <label class="form-check-label" for="expensive">
                <span class="pr-3">گران‌ترین</span>
            </label>
        </div>
    </form>
</div>

<div class="mt-2 bg-white p-3 round">
    <div id="titleMain">جستجو در نتایج:</div>
    <form id="searchBrand">
        <span class="input-group-append">
            <!-- <button class="btn btn-outline-red border border-left-0" type="button"> -->
            <i class="fa fa-search" style="position: relative; right: 0.5rem; top: 2.2rem; z-index: 33333;"></i>
            <!-- </button> -->
        </span>
        <div class="input-group mt-2">
            <input type="text" class="form-control" style="padding-right:2rem;">
        </div>
    </form>
    <form action="">
        {% for brand in brands %}
        <div class="form-check mt-2">
            <input class="form-check-input" type="checkbox" value="brand_{{brand.name}}"" id=" {{brand.name}}"
                value="saeed">
            <label class="form-check-label mr-3 brand" for="{{brand.name}}">
                {{brand.name}}
            </label>
        </div>
        {% endfor %}
    </form>
</div>
<div class="mt-2 bg-white p-3 round">
    <div>
        دوربین‌های پشت گوشی </div>
    <hr>
    <form action="">
        {% for back_camera_module in back_camera_modules %}
        <div class="form-check mt-2">
            <input class="form-check-input" type="checkbox" value="camModule_{{back_camera_module.0}}"
                id="{{back_camera_module.0}}">
            <label class="form-check-label mr-3" for="{{back_camera_module.0}}">
                {{back_camera_module.0}}
            </label>
        </div>
        {% endfor %}
    </form>
</div>
<div class="mt-2 bg-white p-3 round">
    <div>
        شبکه‌های ارتباطی </div>
    <hr>
    <form action="">
        <div class="form-check mt-2">
            <input class="form-check-input" type="checkbox" value="net_2G" id="2G">
            <label class="form-check-label mr-3" for="2G">
                2G
            </label>
        </div>
        <div class="form-check mt-2">
            <input class="form-check-input" type="checkbox" value="net_3G" id="3G">
            <label class="form-check-label mr-3" for="3G">
                3G
            </label>
        </div>
        <div class="form-check mt-2">
            <input class="form-check-input" type="checkbox" value="net_4G" id="4G">
            <label class="form-check-label mr-3" for="4G">
                4G
            </label>
        </div>
        <div class="form-check mt-2">
            <input class="form-check-input" type="checkbox" value="net_5G" id="5G">
            <label class="form-check-label mr-3" for="5G">
                5G
            </label>
        </div>
    </form>
</div>
<div class="mt-2 bg-white p-3 round">
    <div>
        تعداد سیم کارت
    </div>
    <hr>
    <form action="" method="post">
        {% for num_sim_card in num_sim_cards %}
        <div class="form-check mt-2">
            <input class="form-check-input" type="checkbox" value="numSimCard_{{num_sim_card.0}}"
                id="{{num_sim_card.0}}">
            <label class="form-check-label mr-3" for="{{num_sim_card.0}}">
                {{num_sim_card.0}}
            </label>
        </div>
        {% endfor %}
    </form>
</div>
<div class="mt-2 bg-white p-3 round">
    <div>توضیحات سیم کارت</div>
    <hr>
    <form>
        {% for sim_desc in sim_card_desc %}
        <div class="form-check mt-2">
            <input class="form-check-input" type="checkbox" value="simDesc_{{sim_desc.0}}" id="{{sim_desc.0}}">
            <label class="form-check-label mr-3" for="{{sim_desc.0}}">
                {{sim_desc.0}}
            </label>
        </div>
        {% endfor %}
    </form>
</div>
<div class="mt-2 bg-white p-3 round" style="height: 20rem; overflow: auto; white-space: nowrap;">
    <div id="titleDisplay">فناوری صفحه نمایش:</div>
    <form id="search‌‌‌Display">
        <span class="input-group-append">
            <!-- <button class="btn btn-outline-red border border-left-0" type="button"> -->
            <i class="fa fa-search" style="position: relative; right: 0.5rem; top: 2.2rem; z-index: 33333;"></i>
            <!-- </button> -->
        </span>
        <div class="input-group mt-2">
            <input type="text" class="form-control" style="padding-right:2rem;">
        </div>
    </form>
    <form>
        {% for display_techno in display_technos %}
        <div class="form-check mt-2">
            <input class="form-check-input" type="checkbox" value="displayTechno_{{display_techno.0}}"
                id="{{display_techno.0}}">
            <label class="form-check-label mr-3 display" for="{{display_techno.0}}">
                {{display_techno.0}}
            </label>
        </div>
        {% endfor %}
    </form>
</div>
<div class="mt-2 bg-white p-3 round" style="height: 20rem; overflow: auto; white-space: nowrap;">
    <div id="titleResolution">رزولوشن عکس:</div>
    <form id="search‌‌Resolution">
        <span class="input-group-append">
            <!-- <button class="btn btn-outline-red border border-left-0" type="button"> -->
            <i class="fa fa-search" style="position: relative; right: 0.5rem; top: 2.2rem; z-index: 33333;"></i>
            <!-- </button> -->
        </span>
        <div class="input-group mt-2">
            <input type="text" class="form-control" style="padding-right:2rem;">
        </div>
    </form>
    <form action="">
        {% for image_resolution in image_resolutions %}
        <div class="form-check mt-2">
            <input class="form-check-input" type="checkbox" value="imageResolution_{{image_resolution.0}}"
                id="{{resolution.0}}">
            <label class="form-check-label mr-3 resolution" for="{{image_resolution.0}}">
                {{image_resolution.0}}
            </label>
        </div>
        {% endfor %}
    </form>
</div>
<div class="mt-2 bg-white p-3 round" style="height: 20rem; overflow: auto; white-space: nowrap;">
    <div id="titleStorage"> حافظه داخلی:</div>
    <form id="searchStorage">
        <span class="input-group-append">
            <!-- <button class="btn btn-outline-red border border-left-0" type="button"> -->
            <i class="fa fa-search" style="position: relative; right: 0.5rem; top: 2.2rem; z-index: 33333;"></i>
            <!-- </button> -->
        </span>
        <div class="input-group mt-2">
            <input type="text" class="form-control" style="padding-right:2rem;">
        </div>
    </form>
    <form>
        {% for ram in rams %}
        <div class="form-check mt-2">
            <input class="form-check-input" type="checkbox" value="storage_{{ram.0}}" id="{{ram.0}}">
            <label class="form-check-label mr-3 storage" for="{{ram.0}}">
                {{ram.0}}
            </label>
        </div>
        {% endfor %}
    </form>
</div>
<div class="mt-2 bg-white p-3 round" style="height: 20rem; overflow: auto; white-space: nowrap;">
    <div id="titleStorage">ظرفیت حافظه RAM:</div>
    <form id="searchRAM">
        <span class="input-group-append">
            <!-- <button class="btn btn-outline-red border border-left-0" type="button"> -->
            <i class="fa fa-search" style="position: relative; right: 0.5rem; top: 2.2rem; z-index: 33333;"></i>
            <!-- </button> -->
        </span>
        <div class="input-group mt-2">
            <input type="text" class="form-control" style="padding-right:2rem;">
        </div>
    </form>

    <form>
        {% for ram_capacity in ram_capacities %}
        <div class="form-check mt-2">
            <input class="form-check-input" type="checkbox" value="ramCapacity_{{ram_capacity.0}}" name="ram"
                id="{{ram.0}}">
            <label class="form-check-label mr-3 ram" for="{{ram_capacity.0}}">
                {{ram_capacity.0}}
            </label>
        </div>{% endfor %}
    </form>
</div>
<div class="mt-2 bg-white p-3 round" style="height: 20rem; overflow: auto; white-space: nowrap;">
    <div id="titleStorage">اندازه:</div>
    <form id="searchRAM">
        <span class="input-group-append">
            <!-- <button class="btn btn-outline-red border border-left-0" type="button"> -->
            <i class="fa fa-search" style="position: relative; right: 0.5rem; top: 2.2rem; z-index: 33333;"></i>
            <!-- </button> -->
        </span>
        <div class="input-group mt-2">
            <input type="text" class="form-control" style="padding-right:2rem;">
        </div>
    </form>

    <form>
        {% for size in sizes %}
        <div class="form-check mt-2">
            <input class="form-check-input" type="checkbox" value="size_{{size.0}}" name="ram" id="{{ram.0}}">
            <label class="form-check-label mr-3 ram" for="{{size.0}}">
                {{size.0}}
            </label>
        </div>{% endfor %}
    </form>
</div>
<div class="mt-2 bg-white p-3 round" style="height: 20rem; overflow: auto; white-space: nowrap;">
    <div id="titleStorage">نسخه سیستم عامل:</div>
    <form id="searchRAM">
        <span class="input-group-append">
            <!-- <button class="btn btn-outline-red border border-left-0" type="button"> -->
            <i class="fa fa-search" style="position: relative; right: 0.5rem; top: 2.2rem; z-index: 33333;"></i>
            <!-- </button> -->
        </span>
        <div class="input-group mt-2">
            <input type="text" class="form-control" style="padding-right:2rem;">
        </div>
    </form>

    <form>
        {% for os_release in os_releases %}
        <div class="form-check mt-2">
            <input class="form-check-input" type="checkbox" value="osRelease_{{os_release.0}}" name="ram"
                id="{{os_release.0}}">
            <label class="form-check-label mr-3 ram" for="{{os_release.0}}">
                {{os_release.0}}
            </label>
        </div>{% endfor %}
    </form>
</div>
<div class="mt-2 bg-white p-3 round" style="height: 20rem; overflow: auto; white-space: nowrap;">
    <div id="titleStorage">نوع سیستم عامل:</div>
    <form id="searchRAM">
        <span class="input-group-append">
            <!-- <button class="btn btn-outline-red border border-left-0" type="button"> -->
            <i class="fa fa-search" style="position: relative; right: 0.5rem; top: 2.2rem; z-index: 33333;"></i>
            <!-- </button> -->
        </span>
        <div class="input-group mt-2">
            <input type="text" class="form-control" style="padding-right:2rem;">
        </div>
    </form>

    <form>
        {% for os in OS %}
        <div class="form-check mt-2">
            <input class="form-check-input" type="checkbox" value="os_{{os.0}}" name="ram" id="{{os.0}}">
            <label class="form-check-label mr-3 ram" for="{{os.0}}">
                {{os.0}}
            </label>
        </div>{% endfor %}
    </form>
</div>
<div class="mt-2 bg-white p-3 round">
    <div class="slider-box">
        <label for="priceRange" id="sliderLabel">محدوده قیمت مورد نظر:</label>
        <input type="text" id="priceRange" readonly style="background-color: white; border: none;" dir="ltr">
        <div id="price-range" class="slider"></div>
    </div>
</div>
<div class="mt-2 bg-white p-3 round">
    <div class="slider-box">
        <label for="priceRange" id="sliderLabel">محدوده قیمت مورد نظر:</label>
        <input type="text" id="priceRange" readonly style="background-color: white; border: none;" dir="ltr">
        <div id="price-range" class="slider"></div>
    </div>
</div>
{% endblock sidebar %}


{% block script %}
<script src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"
    integrity="sha512-uto9mlQzrs59VwILcLiRYeLKPPbS/bT71da/OEBYEwcdNUk8jYIy+D176RYoop1Da+f9mvkYrmj5MCLZWEtQuA=="
    crossorigin="anonymous"></script>
<script src="{% static 'js/products_list.js' %}"></script>
<script>
    // Select all checkboxes with the name 'settings' using querySelectorAll.
    {% comment %} var checkboxes = document.querySelectorAll("input[type=checkbox]"); {% endcomment %}
    var checkboxes = document.querySelectorAll("input[class=form-check-input]");
    let enabledSettings = []

    /*
    For IE11 support, replace arrow functions with normal functions and
    use a polyfill for Array.forEach:
    https://vanillajstoolkit.com/polyfills/arrayforeach/
    */

    // Use Array.forEach to add an event listener to each checkbox.
    checkboxes.forEach(function (checkbox) {
        checkbox.addEventListener('change', function () {
            enabledSettings =
                Array.from(checkboxes) // Convert checkboxes to an array to use filter and map.
                    .filter(i => i.checked) // Use Array.filter to remove unchecked checkboxes.
                    .map(i => i.value) // Use Array.map to extract only the checkbox values from the array of objects.

            $.ajax({
                type: "get",
                url: "{% url 'products:products_list' cat %}",
                data: {
                    data: enabledSettings,
                },
                dataType: 'JSON',
                success: function (response) {
                    $(".product_list").empty();

                    for (i = 0; i < response['product_ids'].length; i++) {
                        p_id = response['product_ids'][i];
                        var url_mask = "{% url 'products:laptop_view' cat=1234 slug=5678 %}".replace(/1234/, response['cat'].toString());
                        url_mask = url_mask.replace(/5678/, response['product_list'][p_id][2].toString());
                        $('.product_list').append(`<div class="col col-md-3">
                    <div class="card">
                        <a href="${url_mask}"><img class="card-img-top"
                                src="${response['product_list'][p_id][1]}" alt="Card image cap"></a>
                        <div class="card-body">
                            <h5 class="card-title" style="font-size: 0.85rem; color: rgba(0, 0, 0, 0.5);">
                                ${response['product_list'][p_id][0]}</h5>
                            <p class="card-text d-flex justify-content-between">
                                <span><i class="fa fa-check-circle" aria-hidden="true"
                                        style="color: seagreen;"></i><span class="mr-1"
                                        style="font-size: 0.7rem; color:rgba(0, 0, 0, 0.5)">موجود در انبار</span></span>
                                <span dir="ltr"><i class="fas fa-star" style="color: gold; font-size:0.7rem;"></i>${response['rating_dictionary'][p_id][0]} (${response['rating_dictionary'][p_id][1]})<span
                                        style="font-size:0.7rem;"></span></span>
                            </p>
                            <p style="font-size: 1rem; text-align: left;">${response['prices'][p_id]} تومان</p>
                            <ul class="list-group list-group-flush">
                                <li class="list-group-item shop" style="font-size: 0.85rem;">
                                    <i class="fas fa-shopping-cart" style="color: rgba(0, 0, 0, 0.4);"></i>
                                   ${response['shops'][p_id]} <i class="fas fa-smile" style="color: red;"></i>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>`);
                    }
                },
                error: function () { console.log('error in searching') }
            });
        })
    });



</script>
{% endblock script %}